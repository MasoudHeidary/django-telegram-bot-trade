<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>گردونه شانس ربات معاملاتی باشگاه آگاه</title>
    <link href="https://cdn.jsdelivr.net/gh/mohsenjahani/sahel-font/dist/font-face.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
    <!-- Google Fonts Roboto -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">


    <style>
        * {
            font-family: Sahel;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            height: 100vh;
            margin: 0;
            direction: ltr;
            background-color: #5de6de;
            background-image: linear-gradient(315deg, #5de6de 0%, #b58ecc 74%);

        }

        .arrow {
            animation: arrow 1s infinite alternate-reverse;
            animation-play-state: paused;
            position: relative;
            z-index: 10;
            width: 40px;
            margin-top: -20px;
        }

        svg {
            cursor: pointer;
        }

        svg g circle {
            fill: none;
            transition: 0.5s all;
        }

        svg g text, svg g text tspan {
            text-anchor: middle;
            alignment-baseline: middle;
        }

        svg g text {
            font-family: "Sahel Regular", Tahoma, Geneva, Verdana, sans-serif;
            font-size: 2.5vw;
            letter-spacing: -2px;
            direction: rtl;
        }

        svg g text tspan {
            font-size: 20px;
            opacity: 0.5;
        }

        .animate-prize {
            animation: prize 0.5s infinite alternate-reverse;
        }

        .animate-text {
            animation: prizeText 0.5s infinite alternate-reverse;
        }

        @keyframes prize {
            to {
                stroke: #d62525;
            }
        }

        @keyframes prizeText {
            to {
                fill: white;
            }
        }

        @keyframes arrow {
            to {
                transform: translateY(10px);
            }
        }
    </style>
    <style>
        html {
            font-family: Lora !important;
        }

        button {
            width: 80%;
            margin: 10%;
            background-color: #4CAF50; /* Green */
            border: none;
            color: white;
            padding: 16px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            transition-duration: 0.4s;
            cursor: pointer;
            background-color: #008CBA;
            color: white;
        }

        button:hover {
            background-color: red;
            color: black;
        }
    </style>

</head>
<body>
<!-- partial:index.partial.html -->
<svg height="400" width="400" viewBox="0 0 400 400">
    <circle r="100" stroke-width="200" cx="200" cy="200" fill="none"/>
</svg>
<img class="arrow"
     src="data:image/svg+xml,%3Csvg id='Layer_1' width='511' height='600' viewBox='0 0 511.509 511.509' xmlns='http://www.w3.org/2000/svg'%3E%3Cg%3E%3Cg%3E%3Cpath transform='translate(0 10)' stroke='%23ffffff' stroke-width='20' fill='%23df3056' d='m498.675 493.845-233.515-488.277c-3.541-7.424-15.701-7.424-19.243 0l-234.666 490.667c-1.579 3.307-1.344 7.189.597 10.283s5.355 4.992 9.024 4.992h469.76c5.888 0 10.667-4.779 10.667-10.667 0-2.667-.982-5.12-2.624-6.998z'/%3E%3C/g%3E%3C/g%3E%3Cg/%3E%3Cg/%3E%3Cg/%3E%3Cg/%3E%3Cg/%3E%3Cg/%3E%3Cg/%3E%3Cg/%3E%3Cg/%3E%3Cg/%3E%3Cg/%3E%3Cg/%3E%3Cg/%3E%3Cg/%3E%3Cg/%3E%3C/svg%3E"
     alt="">
<button onclick="rotateWheel()">شانست رو امتحان کن</button>
<!-- partial -->
<script>
    const items = [
        '&#1634;&#1632;  &#1586;&#65166;&#64387;&#64389;&#65251;&#1575; &#1585;&#1575;&#1586;&#1726;',
        '&#65258;&#64401;&#65203; &#65226;&#65169&#1585;',
        '&#64378;&#1608;&#64344;',
        '&#1635;&#1632;  &#1586;&#65166;&#64387;&#64389;&#65251;&#1575; &#1585;&#1575;&#1586;&#1726;',
        '&#1585;&#1575;&#65170;&#64389;&#65227;&#1575; &#1781;&#32; &#65258;&#1726;&#65166;&#65251; &#64399;&#65267; &#65249;',
        '&#64378;&#1608;&#64344;',
        '&#1636;&#1632;  &#1586;&#65166;&#64387;&#64389;&#65251;&#1575; &#1585;&#1575;&#1586;&#1726;',
        '&#1585;&#1575;&#65170;&#64389;&#65227;&#1575; &#1635; &#65258;&#1726;&#65166;&#65251; &#64399;&#65267; &#65249;',
        '&#64378;&#1608;&#64344;',
        '&#1781;&#1632;  &#1586;&#65166;&#64387;&#64389;&#65251;&#1575; &#1585;&#1575;&#1586;&#1726;',
        '&#1585;&#1575;&#65170;&#64389;&#65227;&#1575; &#1634; &#65258;&#1726;&#65166;&#65251; &#64399;&#65267; &#65249;',
        '&#64378;&#1608;&#64344;'
    ];
    const svg = document.querySelector('svg');
    const btn = document.querySelector('button');
    const svgCircle = document.querySelector('svg circle');
    const arrow = document.querySelector('.arrow');

    const strokeLength = svgCircle.getTotalLength();
    const itemLength = strokeLength / items.length;
    const itemDegree = 360 / items.length;


    items.forEach((item, index) => {
        const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');

        g.innerHTML = `<circle r="100" stroke-width="200" cx="200" cy="200"
        class="circle${index}" /><text class="text${index}">
        ${item}
        </text>`;

        const itemLengthCenter = (itemLength * index) + (itemLength / 2);
        const textPoint = svgCircle.getPointAtLength(itemLengthCenter);

        const text = g.querySelector('text');

        text.setAttribute('x', textPoint.x);
        text.setAttribute('y', textPoint.y);

        text.style.transformOrigin = `${textPoint.x}px ${textPoint.y}px`
        text.style.transform =
            `rotate(${Math.round(itemLengthCenter * 360 / strokeLength)}deg)`

        const circle = g.querySelector('circle');
        circle.style.strokeDasharray = itemLength + " " + (strokeLength - itemLength);
        circle.style.strokeDashoffset = strokeLength - (itemLength * index);
        const randNum = () => Math.floor(Math.random() * 150) + 100
        circle.style.stroke = `rgb(${randNum()},${randNum()},${randNum()})`;
        svg.appendChild(g);
    })

    let prizeIndexPrev = -1;

    function rotateWheel() {
        btn.style.display = 'none';
        if (prizeIndexPrev > -1) {
            svg.querySelector(`.circle${prizeIndexPrev}`)
                .classList.remove('animate-prize')
            svg.querySelector(`.text${prizeIndexPrev}`)
                .classList.remove('animate-text')
        }
        const randDuration = (Math.random() * 6000) + 7000
        const randDegree = ({{ Degree }}) + 7200
        svg.style.transitionTimingFunction = `cubic-bezier(0.33, 1, 0.68, 1)`
        svg.style.transitionDuration = `${randDuration}ms`
        svg.style.transform = `rotate(${randDegree}deg)`
        arrow.style.animationPlayState = 'running'

        setTimeout(() => {
            const degree360 = randDegree % 360;
            svg.style.transition = ''
            svg.style.transform = `rotate(${degree360}deg)`;
            arrow.style.animationPlayState = 'paused'
            let prizeDegree = 90 - degree360;
            if (prizeDegree < 0) {
                prizeDegree += 360
            }
            const prizeIndex = Math.floor(prizeDegree / itemDegree);
            svg.querySelector(`.circle${prizeIndex}`)
                .classList.add('animate-prize');
            svg.querySelector(`.text${prizeIndex}`)
                .classList.add('animate-text');
            prizeIndexPrev = prizeIndex;
        }, randDuration)
    }
</script>

</body>
</html>
